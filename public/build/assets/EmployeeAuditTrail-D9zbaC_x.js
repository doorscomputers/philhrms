import{c as o,o as d,a as t,t as a,d as m,n as u,b as C,F as g,r as p,e as I,f as A}from"./inertia-app-BhfqKf1u.js";const $={class:"py-6"},E={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8"},P={class:"bg-white shadow rounded-lg mb-6"},B={class:"px-6 py-4 border-b border-gray-200"},L={class:"flex items-center justify-between"},F={class:"mt-1 text-sm text-gray-600"},M={class:"px-6 py-4 bg-gray-50"},O={class:"flex items-center"},U={class:"flex-shrink-0 h-10 w-10"},H={class:"h-10 w-10 rounded-full bg-blue-500 flex items-center justify-center"},R={class:"text-sm font-medium text-white"},V={class:"ml-4"},G={class:"text-sm font-medium text-gray-900"},z={class:"text-sm text-gray-500"},W={class:"ml-auto"},J={class:"bg-white shadow rounded-lg"},Y={class:"px-6 py-4 border-b border-gray-200"},q={class:"flex items-center justify-between"},K={class:"text-right"},Q={class:"text-sm text-gray-500"},X={key:0},Z={class:"hidden lg:block overflow-hidden"},ee={class:"min-w-full divide-y divide-gray-200"},te={class:"bg-white divide-y divide-gray-200"},se={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},ae={class:"font-medium"},re={class:"text-gray-500"},ie={class:"px-6 py-4 whitespace-nowrap"},oe={class:"px-6 py-4 whitespace-nowrap text-sm"},de={class:"font-medium text-gray-900"},ne={key:0,class:"text-gray-500"},ce={class:"px-6 py-4 text-sm"},le={key:0,class:"space-y-2"},me={class:"font-semibold text-gray-800 mb-2 flex items-center"},ue={class:"grid grid-cols-1 md:grid-cols-2 gap-3"},ge={class:"space-y-1"},pe={class:"bg-red-50 border border-red-200 text-red-900 px-3 py-2 rounded-md text-sm"},ye={class:"space-y-1"},he={class:"bg-green-50 border border-green-200 text-green-900 px-3 py-2 rounded-md text-sm"},xe={key:1,class:"text-gray-500 text-sm italic flex items-center"},fe={class:"px-6 py-4 text-sm text-gray-900"},_e={class:"max-w-xs"},be={class:"lg:hidden"},we={class:"space-y-4 p-4"},ke={class:"p-4"},De={class:"flex items-center justify-between mb-3"},ve={class:"text-sm text-gray-500"},Ne={class:"mb-3"},Se={class:"font-medium text-gray-900 mb-1"},Te={class:"text-sm text-gray-600"},Ce={key:0,class:"space-y-3"},je={class:"font-medium text-gray-800 mb-2 text-sm"},Ie={class:"space-y-2"},Ae={class:"bg-red-50 border border-red-200 text-red-900 px-2 py-1 rounded text-sm"},$e={class:"bg-green-50 border border-green-200 text-green-900 px-2 py-1 rounded text-sm"},Ee={key:1,class:"text-gray-500 text-sm italic"},Pe={key:0,class:"bg-white px-4 py-3 border-t border-gray-200 sm:px-6"},Be={class:"flex items-center justify-between"},Le={class:"text-sm text-gray-700"},Fe={class:"flex space-x-1"},Me=["onClick","disabled","innerHTML"],Oe={key:1,class:"text-center py-16"},Re={__name:"EmployeeAuditTrail",props:{employee:Object,auditTrails:Object,lookupData:Object},setup(i){const n=i;console.log("Audit Trail Props:",{hasEmployee:!!n.employee,hasAuditTrails:!!n.auditTrails,hasLookupData:!!n.lookupData,lookupData:n.lookupData});const j=r=>{r&&A.visit(r,{preserveState:!0,replace:!0})},x=r=>new Date(r).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),f=r=>new Date(r).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",second:"2-digit"}),_=r=>{switch(r){case"created":return"bg-green-100 text-green-800";case"updated":return"bg-blue-100 text-blue-800";case"deleted":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},b=r=>{switch(r){case"created":return"fas fa-plus";case"updated":return"fas fa-pencil";case"deleted":return"fas fa-trash";default:return"fas fa-info"}},w=r=>{switch(r){case"created":return"Record Created";case"updated":return"Record Updated";case"deleted":return"Record Deleted";default:return"System Action"}},h=r=>({first_name:"First Name",last_name:"Last Name",middle_name:"Middle Name",preferred_name:"Preferred Name",employee_id:"Employee ID",badge_number:"Badge Number",biometric_id:"Biometric ID",updated_at:"Last Updated",email:"Email Address",phone:"Phone Number",mobile_phone:"Mobile Phone",hire_date:"Hire Date",birth_date:"Birth Date",gender:"Gender",marital_status:"Marital Status",nationality:"Nationality",religion:"Religion",department_id:"Department",position_id:"Position",job_grade_id:"Job Grade",employment_status_id:"Employment Status",work_schedule_id:"Work Schedule",branch_id:"Branch",cost_center_id:"Cost Center",supervisor_id:"Supervisor",is_active:"Active Status",basic_salary:"Basic Salary",allowances:"Allowances",probation_end_date:"Probation End Date",regularization_date:"Regularization Date",contract_start_date:"Contract Start Date",contract_end_date:"Contract End Date",address:"Address",emergency_contacts:"Emergency Contacts",education_background:"Education Background",work_experience:"Work Experience",certifications:"Certifications",skills:"Skills",tin_number:"TIN Number",sss_number:"SSS Number",philhealth_number:"PhilHealth Number",pagibig_number:"Pag-IBIG Number"})[r]||r.replace(/_/g," ").replace(/\b\w/g,s=>s.toUpperCase()).replace(/Id$/,"ID"),y=(r,e)=>{if(e==null||e==="")return"Not specified";if(r==="department_id"&&console.log("Department lookup debug:",{fieldName:r,value:e,valueType:typeof e,hasLookupData:!!n.lookupData,hasDepartments:!!n.lookupData?.departments,lookup:n.lookupData?.departments?.[e],allDepts:n.lookupData?.departments}),typeof e=="boolean")return e?"Yes":"No";switch(r){case"is_active":return e===!0||e===1||e==="1"?"Active":"Inactive";case"gender":return e==="M"?"Male":e==="F"?"Female":e;case"basic_salary":case"allowances":return typeof e=="number"?new Intl.NumberFormat("en-PH",{style:"currency",currency:"PHP"}).format(e):e;case"hire_date":case"birth_date":case"probation_end_date":case"regularization_date":case"contract_start_date":case"contract_end_date":return e?new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}):"Not specified";case"employee_id":return e||"Not assigned";case"badge_number":return e||"Not assigned";case"biometric_id":return e||"Not assigned";case"updated_at":return e?new Date(e).toLocaleString("en-US",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit",second:"2-digit"}):"Not specified";case"department_id":if(!e)return"No department assigned";const s=n.lookupData?.departments?.[e];return s||`Department ID: ${e}`;case"position_id":if(!e)return"No position assigned";const l=n.lookupData?.positions?.[e];return l||`Position (ID: ${e})`;case"job_grade_id":if(!e)return"No job grade assigned";const c=n.lookupData?.jobGrades?.[e];return c||`Job Grade (ID: ${e})`;case"employment_status_id":if(!e)return"No employment status assigned";const D=n.lookupData?.employmentStatuses?.[e];return D||`Employment Status (ID: ${e})`;case"work_schedule_id":if(!e)return"No work schedule assigned";const v=n.lookupData?.workSchedules?.[e];return v||`Work Schedule (ID: ${e})`;case"branch_id":if(!e)return"No branch assigned";const N=n.lookupData?.branches?.[e];return N||`Branch (ID: ${e})`;case"cost_center_id":if(!e)return"No cost center assigned";const S=n.lookupData?.costCenters?.[e];return S||`Cost Center (ID: ${e})`;case"supervisor_id":if(!e)return"No supervisor assigned";const T=n.lookupData?.users?.[e];return T||`Supervisor (ID: ${e})`;default:if(Array.isArray(e))return e.length>0?`${e.length} items`:"Empty";if(typeof e=="object")try{return JSON.stringify(e,null,2)}catch{return"Complex data"}return String(e)}},k=r=>{if(r.description&&r.description!=="Record modified")return r.description;const e=r.changed_fields;if(!e||Object.keys(e).length===0)switch(r.action){case"created":return"Employee record was created in the system";case"updated":return"Employee record was updated";case"deleted":return"Employee record was deleted from the system";default:return"System action performed on employee record"}const s=Object.keys(e).length,l=Object.keys(e).map(c=>h(c));return s===1?`Updated ${l[0]}`:s<=3?`Updated ${l.join(", ")}`:`Updated ${s} fields: ${l.slice(0,2).join(", ")} and ${s-2} more`};return(r,e)=>(d(),o("div",$,[t("div",E,[t("div",P,[t("div",B,[t("div",L,[t("div",null,[e[1]||(e[1]=t("h1",{class:"text-2xl font-bold text-gray-900"},"Audit Trail",-1)),t("p",F," Complete change history for "+a(i.employee.first_name)+" "+a(i.employee.last_name),1)]),t("button",{onClick:e[0]||(e[0]=s=>r.$inertia.visit(`/spa/employees/${i.employee.id}`)),class:"inline-flex items-center px-4 py-2 border border-gray-300 rounded-md shadow-sm bg-white text-sm font-medium text-gray-700 hover:bg-gray-50"},[...e[2]||(e[2]=[t("i",{class:"fas fa-arrow-left mr-2"},null,-1),m(" Back to Employee ",-1)])])])]),t("div",M,[t("div",O,[t("div",U,[t("div",H,[t("span",R,a(i.employee.first_name?.[0])+a(i.employee.last_name?.[0]),1)])]),t("div",V,[t("div",G,a(i.employee.first_name)+" "+a(i.employee.last_name),1),t("div",z," Employee ID: "+a(i.employee.employee_id)+" | "+a(i.employee.department?.name||"No Department")+" | "+a(i.employee.position?.name||"No Position"),1)]),t("div",W,[t("span",{class:u([i.employee.is_active?"bg-green-100 text-green-800":"bg-red-100 text-red-800","inline-flex px-2 py-1 text-xs font-semibold rounded-full"])},a(i.employee.is_active?"Active":"Inactive"),3)])])])]),t("div",J,[t("div",Y,[t("div",q,[e[4]||(e[4]=t("div",null,[t("h3",{class:"text-lg font-medium text-gray-900 flex items-center"},[t("i",{class:"fas fa-history text-blue-500 mr-2"}),m(" Change History & Activity Log ")]),t("p",{class:"mt-1 text-sm text-gray-600"}," Complete record of all changes made to this employee's information, showing what was changed, when, and by whom ")],-1)),t("div",K,[t("div",Q," Total Records: "+a(i.auditTrails.total||i.auditTrails.data.length),1),e[3]||(e[3]=t("div",{class:"text-xs text-gray-400"}," Showing detailed change tracking ",-1))])])]),i.auditTrails.data.length>0?(d(),o("div",X,[t("div",Z,[t("table",ee,[e[9]||(e[9]=t("thead",{class:"bg-gray-50"},[t("tr",null,[t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},[t("i",{class:"fas fa-calendar mr-1"}),m(" When ")]),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},[t("i",{class:"fas fa-cog mr-1"}),m(" Action Type ")]),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},[t("i",{class:"fas fa-user mr-1"}),m(" Made By ")]),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},[t("i",{class:"fas fa-edit mr-1"}),m(" Field Changes ")]),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},[t("i",{class:"fas fa-info-circle mr-1"}),m(" Description ")])])],-1)),t("tbody",te,[(d(!0),o(g,null,p(i.auditTrails.data,s=>(d(),o("tr",{key:s.id,class:"hover:bg-gray-50"},[t("td",se,[t("div",ae,a(x(s.created_at)),1),t("div",re,a(f(s.created_at)),1)]),t("td",ie,[t("span",{class:u([_(s.action),"inline-flex items-center px-3 py-2 rounded-full text-sm font-medium"])},[t("i",{class:u([b(s.action),"mr-2"])},null,2),m(" "+a(w(s.action)),1)],2)]),t("td",oe,[t("div",de,a(s.user?.name||s.user_name||"System"),1),s.ip_address?(d(),o("div",ne," IP: "+a(s.ip_address),1)):C("",!0)]),t("td",ce,[s.changed_fields&&Object.keys(s.changed_fields).length>0?(d(),o("div",le,[(d(!0),o(g,null,p(s.changed_fields,(l,c)=>(d(),o("div",{key:c,class:"border border-gray-200 rounded-lg p-3 bg-gray-50"},[t("div",me,[e[5]||(e[5]=t("i",{class:"fas fa-edit text-blue-500 mr-2"},null,-1)),m(" "+a(h(c)),1)]),t("div",ue,[t("div",ge,[e[6]||(e[6]=t("div",{class:"text-xs font-medium text-gray-600 uppercase tracking-wide"},"Previous Value",-1)),t("div",pe,a(y(c,l.old)),1)]),t("div",ye,[e[7]||(e[7]=t("div",{class:"text-xs font-medium text-gray-600 uppercase tracking-wide"},"New Value",-1)),t("div",he,a(y(c,l.new)),1)])])]))),128))])):(d(),o("div",xe,[...e[8]||(e[8]=[t("i",{class:"fas fa-info-circle mr-2"},null,-1),m(" No specific field changes recorded ",-1)])]))]),t("td",fe,[t("div",_e,a(k(s)),1)])]))),128))])])]),t("div",be,[t("div",we,[(d(!0),o(g,null,p(i.auditTrails.data,s=>(d(),o("div",{key:s.id,class:"bg-white border border-gray-200 rounded-lg shadow-sm overflow-hidden"},[t("div",ke,[t("div",De,[t("span",{class:u([_(s.action),"inline-flex items-center px-3 py-1 rounded-full text-sm font-medium"])},[t("i",{class:u([b(s.action),"mr-2"])},null,2),m(" "+a(w(s.action)),1)],2),t("div",ve,a(x(s.created_at)),1)]),t("div",Ne,[t("h4",Se,a(k(s)),1),t("p",Te," By "+a(s.user?.name||s.user_name||"System")+" at "+a(f(s.created_at)),1)]),s.changed_fields&&Object.keys(s.changed_fields).length>0?(d(),o("div",Ce,[(d(!0),o(g,null,p(s.changed_fields,(l,c)=>(d(),o("div",{key:c,class:"border border-gray-200 rounded-lg p-3 bg-gray-50"},[t("div",je,a(h(c)),1),t("div",Ie,[t("div",null,[e[10]||(e[10]=t("div",{class:"text-xs text-gray-600 mb-1"},"From:",-1)),t("div",Ae,a(y(c,l.old)),1)]),t("div",null,[e[11]||(e[11]=t("div",{class:"text-xs text-gray-600 mb-1"},"To:",-1)),t("div",$e,a(y(c,l.new)),1)])])]))),128))])):(d(),o("div",Ee," No specific field changes recorded "))])]))),128))])]),i.auditTrails.links&&i.auditTrails.links.length>3?(d(),o("div",Pe,[t("div",Be,[t("div",Le," Showing "+a(i.auditTrails.from)+" to "+a(i.auditTrails.to)+" of "+a(i.auditTrails.total)+" entries ",1),t("div",Fe,[(d(!0),o(g,null,p(i.auditTrails.links,s=>(d(),o("button",{key:s.label,onClick:l=>j(s.url),disabled:!s.url,class:u([{"bg-blue-600 text-white":s.active,"bg-gray-300 text-gray-500 cursor-not-allowed":!s.url,"bg-white text-gray-700 hover:bg-gray-50 border-gray-300":s.url&&!s.active},"px-3 py-2 text-sm font-medium border rounded-md"]),innerHTML:s.label},null,10,Me))),128))])])])):C("",!0)])):(d(),o("div",Oe,[...e[12]||(e[12]=[I('<div class="mx-auto flex items-center justify-center h-16 w-16 rounded-full bg-blue-100 mb-4"><i class="fas fa-history text-2xl text-blue-500"></i></div><h3 class="text-lg font-medium text-gray-900 mb-2">No Activity Found</h3><p class="text-gray-500 max-w-sm mx-auto"> This employee record has no recorded changes yet. Once modifications are made to their information, all changes will be tracked and displayed here with full details. </p><div class="mt-6 p-4 bg-blue-50 rounded-lg max-w-md mx-auto"><p class="text-sm text-blue-700"><i class="fas fa-info-circle mr-2"></i> The audit trail will automatically capture all future updates including field changes, timestamps, and the user who made each modification. </p></div>',4)])]))])])]))}};export{Re as default};
